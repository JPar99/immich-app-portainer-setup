# -------------------------------------------------------------------
# Environment file for Immich v1.139.4 + Immich PowerTools v0.18.0
# Sources:
#   Immich: https://github.com/immich-app/immich/tree/v1.139.4
#   PowerTools: https://github.com/varun-raj/immich-power-tools/tree/v0.18.0
# -------------------------------------------------------------------

NODE_ENV=production
TZ=Europe/Amsterdam               # Choose your own timezone (e.g., Europe/Amsterdam)

# -------------------
# DATABASE (Postgres)
# -------------------
DB_HOSTNAME=immich-db              # Immich expects this var (matches immich-db service hostname in compose)
DB_USERNAME=immichuser             # Must match POSTGRES_USER below
DB_PASSWORD=qPh67GqNN912643jhkL    # Avoid special chars on Synology; long and random is safer
DB_DATABASE_NAME=immich            # Must match POSTGRES_DB below
DB_STORAGE_TYPE=HDD                # Optional flag (SSD/HDD) — only advisory in Immich

# Postgres init vars (server container)
POSTGRES_DB=immich                 # Database name created on first run
POSTGRES_USER=immichuser           # Initial user
POSTGRES_PASSWORD=immichpw         # Initial password for DB user (must match DB_PASSWORD above if you want consistency)

# -------------------
# IMMICH APP SETTINGS
# -------------------
LOG_LEVEL=log                      # log | verbose | debug
JWT_SECRET=B6V3tQaslpcLW6HRlDiSkE390mjFJVWJtrdDkmGCGEATjEvDjA4bZgg71zTYqCfEi33iMK78A7h9SKuW645LXoQPAbOjeUgQu8t6Y1qEa2m91YuQ09Ut04HJ3s3C9KsH
# Generate your own 128-char secret: https://it-tools.tech/token-generator?length=128 (deselect symbols!)

DISABLE_REVERSE_GEOCODING=false    # Set true to skip reverse geocoding for photos
REVERSE_GEOCODING_PRECISION=3      # Precision level for location rounding
PUBLIC_LOGIN_PAGE_MESSAGE=         # Optional banner on login page (e.g., "Welcome to our instance")

# Internal service URLs (only used inside the Docker network; no need to change)
IMMICH_WEB_URL=http://immich-web:3000
IMMICH_SERVER_URL=http://immich-server:3001
IMMICH_MACHINE_LEARNING_URL=http://immich-machine-learning:3003
REDIS_HOSTNAME=immich-redis

# -------------------
# VOLUME / STORAGE PATHS (adjust to your NAS folder structure)
# -------------------
DB_DATA_LOCATION=/volume1/docker/immich/db
CACHE_LOCATION=/volume1/docker/immich/cache
MATPLOTLIB_LOCATION=/volume1/docker/immich/matplotlib
REDIS_LOCATION=/volume1/docker/immich/redis
UPLOAD_LOCATION=/volume1/docker/immich/upload

# -------------------
# VERSION CONTROL
# -------------------
IMMICH_VERSION=v1.139.4            # Pin your Immich version (matches upstream tag)
REDIS_VERSION=8-bookworm@sha256:a137a2b60aca1a75130022d6bb96af423fefae4eb55faf395732db3544803280
# Pin Valkey/Redis version (with sha for reproducibility)
POWERTOOLS_VERSION=0.18.0          # Pin PowerTools version (matches GitHub release)

# -------------------
# POWERTOOLS SETTINGS
# -------------------
IMMICH_API_KEY=apikeyforpowertools  # Use Immich "Master API Key" (Admin, full privileges)
IMMICH_URL=http://internalip:8212   # Internal URL of Immich (match NAS IP + Immich port in compose)
EXTERNAL_IMMICH_URL=                # Optional: public URL if Immich is exposed externally

DB_PORT=5432                        # Default Postgres port
DB_HOST=immich-db                   # PowerTools expects DB_HOST (must equal DB_HOSTNAME above!)

# Optional integrations (PowerTools features)
GOOGLE_MAPS_API_KEY=                # Required for geo heatmap feature
GEMINI_API_KEY=                     # Required for AI search feature (Google Gemini API)



#⚠️ Cross-checks / gotchas

#DB_HOSTNAME (Immich) must equal DB_HOST (PowerTools). Keep both in sync.

#DB_PASSWORD vs POSTGRES_PASSWORD: Immich uses DB_PASSWORD, Postgres init uses POSTGRES_PASSWORD. To avoid confusion, set them the same. Or handle it as you like.

#On Synology, avoid symbols in DB and JWT secrets because YAML parsing + Synology filesystem can choke. Stick to alphanumerics.

#Cache paths (CACHE_LOCATION, MATPLOTLIB_LOCATION) must be writable by UID 1026:GID 100 (your Synology Docker user).
